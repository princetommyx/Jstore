<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - J-Shop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Google Platform Library -->
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <!-- Add your Google Client ID here -->
    <meta name="google-signin-client_id" content="YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-image: url('https://images.unsplash.com/photo-1483985988355-763728e1935b?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
    </style>
</head>

<body class="flex items-center justify-center min-h-screen">

    <div class="w-full max-w-md bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl p-8 m-4">
        <div class="text-center mb-8">
            <a href="index.html" class="text-4xl font-bold text-orange-600">J-Shop</a>
            <h2 class="mt-4 text-2xl font-semibold text-gray-700">Welcome Back!</h2>
            <p class="text-gray-500">Sign in to continue your shopping journey.</p>
        </div>

        <form id="login-form" action="#" method="POST">
            <div class="mb-5">
                <label for="email" class="block mb-2 text-sm font-medium text-gray-600">Email Address</label>
                <input type="email" name="email" id="email"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 transition"
                    placeholder="you@example.com" required>
            </div>
            <div class="mb-6">
                <label for="password" class="block mb-2 text-sm font-medium text-gray-600">Password</label>
                <input type="password" name="password" id="password"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 transition"
                    placeholder="••••••••" required>
                <div class="text-right mt-2">
                    <a href="#" class="text-sm text-orange-600 hover:underline">Forgot Password?</a>
                </div>
            </div>

            <div>
                <button type="submit"
                    class="w-full bg-orange-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-orange-700 transition duration-300 transform hover:scale-105 shadow-lg">Login</button>
            </div>

            <div class="my-6 flex items-center">
                <div class="flex-grow border-t border-gray-300"></div>
                <span class="mx-4 text-sm text-gray-500">OR</span>
                <div class="flex-grow border-t border-gray-300"></div>
            </div>

            <div>
                <button id="google-signin-btn" type="button"
                    class="w-full flex items-center justify-center bg-white border border-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-lg hover:bg-gray-50 transition duration-300 shadow-sm">
                    <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="48px"
                        height="48px">
                        <path fill="#FFC107"
                            d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z" />
                        <path fill="#FF3D00"
                            d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z" />
                        <path fill="#4CAF50"
                            d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.223,0-9.657-3.356-11.303-7.962l-6.571,4.819C9.656,39.663,16.318,44,24,44z" />
                        <path fill="#1976D2"
                            d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571l6.19,5.238C42.021,35.596,44,30.038,44,24C44,22.659,43.862,21.35,43.611,20.083z" />
                    </svg>
                    Sign in with Google
                </button>
            </div>
        </form>

        <p class="text-center text-sm text-gray-600 mt-8">
            Don't have an account? <a href="signup.html" class="font-semibold text-orange-600 hover:underline">Sign
                up</a>
        </p>

    </div>

    <script>
        function onSignIn(googleUser) {
            // Get user profile information
            var profile = googleUser.getBasicProfile();
            console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
            console.log('Name: ' + profile.getName());
            console.log('Image URL: ' + profile.getImageUrl());
            console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.

            // The ID token you need to pass to your backend:
            var id_token = googleUser.getAuthResponse().id_token;
            console.log("ID Token: " + id_token);

            // Here you would typically send the id_token to your backend server
            // to verify it and create a session for the user.
            // For now, we'll set a simple client-side flag and redirect to the main page.
            try {
                localStorage.setItem('jshop_logged_in', 'true');
                localStorage.setItem('jshop_user_email', profile.getEmail() || '');
            } catch (err) {
                console.warn('localStorage not available', err);
            }
            window.location.href = 'index.html';
        }

        function attachSignin(element) {
            const clientId = 'YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com';

            // Check if the Client ID is still the placeholder
            if (clientId.startsWith('YOUR_GOOGLE_CLIENT_ID')) {
                console.warn('Google Sign-In is not configured. Please replace "YOUR_GOOGLE_CLIENT_ID" in the HTML file.');
                element.addEventListener('click', () => {
                    console.error('Cannot sign in with Google. Client ID is not set.');
                });
                return;
            }

            gapi.load('auth2', function () {
                auth2 = gapi.auth2.init({
                    client_id: clientId,
                    cookiepolicy: 'single_host_origin',
                });
                auth2.attachClickHandler(element, {},
                    onSignIn,
                    function (error) {
                        // Using console.error instead of alert to avoid script errors in the environment
                        console.error('Google Sign-In Error:', JSON.stringify(error, undefined, 2));
                    });
            });
        }

        // Wait for the DOM to load before attaching the click handler and form handler
        document.addEventListener("DOMContentLoaded", function () {
            attachSignin(document.getElementById('google-signin-btn'));

            // Handle regular email/password login: set a simple logged-in flag and redirect
            const loginForm = document.getElementById('login-form');
            if (loginForm) {
                loginForm.addEventListener('submit', function (e) {
                    e.preventDefault();
                    const emailInput = document.getElementById('email');
                    const email = emailInput ? emailInput.value : '';
                    try {
                        localStorage.setItem('jshop_logged_in', 'true');
                        localStorage.setItem('jshop_user_email', email);
                    } catch (err) {
                        console.warn('localStorage not available', err);
                    }
                    window.location.href = 'index.html';
                });
            }
        });
    </script>
</body>

</html>